(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,95608,e=>{e.v({bottomLeft:"GuideDot-module__6pWM-a__bottomLeft",bottomRight:"GuideDot-module__6pWM-a__bottomRight",guideDot:"GuideDot-module__6pWM-a__guideDot",topLeft:"GuideDot-module__6pWM-a__topLeft",topRight:"GuideDot-module__6pWM-a__topRight"})},89633,e=>{e.v({black:"Disc-module__bexTPq__black",bottom:"Disc-module__bexTPq__bottom",buttercat:"Disc-module__bexTPq__buttercat",buttercatRotate:"Disc-module__bexTPq__buttercatRotate",buttercatSpin:"Disc-module__bexTPq__buttercatSpin",colorChange:"Disc-module__bexTPq__colorChange",colorChangeToBlackSide:"Disc-module__bexTPq__colorChangeToBlackSide",colorChangeToBlackTop:"Disc-module__bexTPq__colorChangeToBlackTop",colorChangeToWhiteSide:"Disc-module__bexTPq__colorChangeToWhiteSide",colorChangeToWhiteTop:"Disc-module__bexTPq__colorChangeToWhiteTop",disc:"Disc-module__bexTPq__disc",emoji:"Disc-module__bexTPq__emoji",flip:"Disc-module__bexTPq__flip",flipping:"Disc-module__bexTPq__flipping",side:"Disc-module__bexTPq__side",specialDiscBlackToWhiteToBlackSide:"Disc-module__bexTPq__specialDiscBlackToWhiteToBlackSide",specialDiscBlackToWhiteToBlackTop:"Disc-module__bexTPq__specialDiscBlackToWhiteToBlackTop",specialDiscWhiteToBlackToWhiteSide:"Disc-module__bexTPq__specialDiscWhiteToBlackToWhiteSide",specialDiscWhiteToBlackToWhiteTop:"Disc-module__bexTPq__specialDiscWhiteToBlackToWhiteTop",spin360:"Disc-module__bexTPq__spin360",top:"Disc-module__bexTPq__top",white:"Disc-module__bexTPq__white"})},52683,e=>{"use strict";e.s(["default",()=>N],52683);var t=e.i(43476),s=e.i(71645),i=e.i(95608);let l={GAME_TITLE:"ButterCatOthello",BLACK_PLAYER:"黒プレイヤー",WHITE_PLAYER:"白プレイヤー",CURRENT_TURN_SUFFIX:" (現在のターン)",CURRENT_TURN_LABEL:"現在のターン:",BLACK:"黒",WHITE:"白",GAME_OVER:"ゲーム終了！",SELECT_DISC_MESSAGE:"手札からディスクを選択してください",PASS_MESSAGE:"がパスしました",BLACK_WINS:"黒の勝利！",WHITE_WINS:"白の勝利！",DRAW:"引き分け！",SPECIAL_DISCS_TITLE:"特殊駒の説明",BUTTER_DISC_TITLE:"バター駒",BUTTER_DISC_DESCRIPTION:"配置すると相手の色になります。挟まれても色は変わりません。中央16マスには置けません。",CAT_DISC_TITLE:"猫駒",CAT_DISC_DESCRIPTION:"配置すると自分の色になります。挟まれても色は変わりません。中央16マスには置けません。",BUTTERCAT_DISC_TITLE:"バター猫駒",BUTTERCAT_DISC_DESCRIPTION:"常に回転し続けます。挟むことができませんが、挟まれることもありません。中央16マスには置けません。",BUTTER_EMOJI:"🧈",CAT_EMOJI:"🐈",BUTTERCAT_EMOJI:"🧈🐈",SETTINGS_TITLE:"ゲーム設定",GAME_MODE_LABEL:"ゲームモード:",MODE_PVP:"対戦モード",MODE_CPU_EASY:"CPU (Easy)",MODE_CPU_HARD:"CPU (Hard)",CPU_COLOR_LABEL:"CPUの色:",NEW_GAME_BUTTON:"新しいゲームを開始",CLOSE_SETTINGS_BUTTON:"閉じる",OPEN_SETTINGS_BUTTON:"設定"};var r=e.i(89633);let c=e=>{let{color:s,discType:i,isFlipping:c}=e,a="buttercat"===i?r.default.buttercat:"black"===s?r.default.black:r.default.white,n="buttercat"===i?r.default.buttercatRotate:"",o="butter"===i?l.BUTTER_EMOJI:"cat"===i?l.CAT_EMOJI:null;return(0,t.jsxs)("div",{className:"".concat(r.default.disc," ").concat(a," ").concat(c?r.default.flipping:""," ").concat(n),"data-flipping-to":c?"black"===s?"black":"white":void 0,"data-disc-type":i,children:[(0,t.jsx)("div",{className:r.default.top,children:o&&(0,t.jsx)("span",{className:r.default.emoji,children:o})}),(0,t.jsx)("div",{className:r.default.side}),(0,t.jsx)("div",{className:r.default.bottom,children:o&&(0,t.jsx)("span",{className:r.default.emoji,children:o})})]})},a={HAND_DISC:{BASE:"w-12 h-12 sm:w-16 sm:h-16 border-2 flex items-center justify-center transition-all",CURSOR_DISABLED:"cursor-not-allowed",CURSOR_POINTER:"cursor-pointer",BORDER_SELECTED:"border-yellow-400 bg-yellow-100",BORDER_DEFAULT:"border-gray-400 bg-gray-100",HOVER:"hover:bg-gray-200",DISABLED:"opacity-30",DISC_CONTAINER:"rounded-full w-8 h-8 sm:w-10 sm:h-10 relative flex items-center justify-center",EMOJI:"text-base sm:text-xl"},HAND:{CONTAINER_BASE:"p-3 sm:p-4 rounded-lg border-2",CONTAINER_ACTIVE:"border-gray-300",CONTAINER_INACTIVE:"bg-gray-50 border-gray-300",BG_PULSE:"animate-pulse bg-yellow-200",TITLE:"mb-2 font-bold text-base sm:text-lg h-6 sm:h-7",MESSAGE_CONTAINER:"mb-2 h-4 sm:h-5",MESSAGE_TEXT:"text-xs sm:text-sm text-red-600",DISCS_CONTAINER:"flex gap-1 sm:gap-2 flex-wrap justify-center",DISC_COUNT:"text-sm sm:text-base font-semibold mt-2 pt-2 border-t border-gray-300"},CELL:{BASE:"w-10 h-10 sm:w-16 sm:h-16 md:w-20 md:h-20 border border-neutral-900 flex items-center justify-center relative",BG:"bg-emerald-700",HOVER:"cursor-pointer hover:bg-emerald-600",VALID_MOVE_DOT:"rounded-full w-2 h-2 sm:w-3 sm:h-3 md:w-4 md:h-4 bg-yellow-300"},BOARD:{GRID:"grid grid-cols-8 gap-0 border-2 sm:border-4 border-neutral-900"},PAGE:{MAIN:"min-h-screen flex flex-col items-center justify-center bg-orange-200 p-2 sm:p-4 md:p-8",TITLE:"text-xl sm:text-2xl md:text-3xl text-neutral-900 font-bold mb-2 sm:mb-4",TURN_DISPLAY:"mb-2 sm:mb-4 text-base sm:text-lg md:text-xl text-neutral-900 font-semibold",GAME_OVER:"mb-2 sm:mb-4 text-lg sm:text-xl md:text-2xl text-red-600 font-bold",HANDS_CONTAINER:"flex flex-col sm:flex-row gap-3 sm:gap-4 md:gap-8 mb-4 sm:mb-8 w-full max-w-4xl",HANDS_ITEM:"flex-1",WINNER_MESSAGE:"mb-2 sm:mb-4 text-xl sm:text-2xl md:text-3xl font-bold text-green-600"},SPECIAL_DISCS:{CONTAINER:"mt-4 sm:mt-6 md:mt-8 p-3 sm:p-4 md:p-6 bg-white rounded-lg shadow-lg max-w-4xl w-full",TITLE:"text-lg sm:text-xl md:text-2xl font-bold mb-2 sm:mb-3 md:mb-4 text-neutral-900",GRID:"grid grid-cols-1 md:grid-cols-3 gap-2 sm:gap-3 md:gap-4",CARD_BASE:"p-2 sm:p-3 md:p-4 rounded-lg",CARD_BUTTER:"border-2 border-amber-400",CARD_CAT:"border-2 border-blue-400",CARD_BUTTERCAT:"border-2 border-gradient-to-br from-amber-400 to-red-900",CARD_HEADER:"flex items-center mb-1 sm:mb-2",CARD_EMOJI:"text-xl sm:text-2xl md:text-3xl mr-1 sm:mr-2",CARD_TITLE:"text-sm sm:text-base md:text-lg font-bold text-neutral-900",CARD_TEXT:"text-xs sm:text-sm text-neutral-700"},DISC_COLORS:{BLACK:"bg-black",WHITE:"bg-white border border-gray-300",BUTTERCAT:"bg-gradient-to-br from-amber-400 to-red-900"},SETTINGS:{OVERLAY:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",MODAL:"bg-yellow-50 rounded-lg shadow-xl p-4 sm:p-6 md:p-8 max-w-md w-full border-4 border-amber-800",TITLE:"text-xl sm:text-2xl font-bold mb-4 sm:mb-6 text-amber-900",SECTION:"mb-4 sm:mb-6",LABEL:"block text-sm sm:text-base font-semibold mb-2 text-amber-900",SELECT:"w-full p-2 border-2 border-amber-600 rounded-lg text-sm sm:text-base bg-white hover:border-amber-700 focus:border-amber-800 focus:ring-2 focus:ring-amber-300 outline-none transition-colors",BUTTON_PRIMARY:"w-full px-4 py-2 sm:py-3 bg-amber-600 hover:bg-amber-700 text-white font-semibold rounded-lg transition-colors text-sm sm:text-base shadow-md",BUTTON_SECONDARY:"w-full px-4 py-2 sm:py-3 bg-amber-200 hover:bg-amber-300 text-amber-900 font-semibold rounded-lg transition-colors mt-2 text-sm sm:text-base",OPEN_BUTTON:"fixed top-2 sm:top-4 right-2 sm:right-4 px-3 sm:px-4 py-1.5 sm:py-2 bg-amber-600 hover:bg-amber-700 text-white font-semibold rounded-lg shadow-lg transition-colors text-sm sm:text-base z-10"}},n=e=>{let{x:s,y:l,color:r,discType:n,isValidMove:o,isFlipping:d,onClick:u}=e,h=s%4==2&&l%4==2?i.default.topLeft:s%4==1&&l%4==2?i.default.topRight:s%4==2&&l%4==1?i.default.bottomLeft:s%4==1&&l%4==1?i.default.bottomRight:null;return(0,t.jsxs)("div",{className:"".concat(a.CELL.BASE," ").concat(a.CELL.BG," ").concat(o?a.CELL.HOVER:""),onClick:u,children:[r&&(0,t.jsx)(c,{color:r,discType:n||"normal",isFlipping:d}),!r&&o&&(0,t.jsx)("div",{className:a.CELL.VALID_MOVE_DOT}),h&&(0,t.jsx)("div",{className:"".concat(i.default.guideDot," ").concat(h)})]})},o=e=>{let{board:s,onCellClick:i}=e;return(0,t.jsx)("div",{className:a.BOARD.GRID,children:s.map((e,s)=>e.map((e,l)=>(0,t.jsx)(n,{x:e.x,y:e.y,color:e.color,discType:e.discType,isValidMove:e.isValidMove,isFlipping:e.isFlipping,onClick:()=>i(e.x,e.y)},"".concat(l,"-").concat(s))))})},d=e=>{let{color:s,type:i,isUsed:r,isSelected:c,isDisabled:n,onClick:o}=e,d="buttercat"===i?a.DISC_COLORS.BUTTERCAT:"butter"===i?"black"===s?a.DISC_COLORS.WHITE:a.DISC_COLORS.BLACK:"black"===s?a.DISC_COLORS.BLACK:a.DISC_COLORS.WHITE,u="butter"===i?l.BUTTER_EMOJI:"cat"===i?l.CAT_EMOJI:null;return(0,t.jsx)("div",{className:"".concat(a.HAND_DISC.BASE," ").concat(r||n?a.HAND_DISC.CURSOR_DISABLED:a.HAND_DISC.CURSOR_POINTER," ").concat(c?a.HAND_DISC.BORDER_SELECTED:a.HAND_DISC.BORDER_DEFAULT," ").concat(r||n?"":a.HAND_DISC.HOVER," ").concat(r||n?a.HAND_DISC.DISABLED:""),onClick:r||n?void 0:o,children:!r&&(0,t.jsx)("div",{className:"".concat(a.HAND_DISC.DISC_CONTAINER," ").concat(d),children:u&&(0,t.jsx)("span",{className:a.HAND_DISC.EMOJI,children:u})})})},u=e=>{let{color:s,discs:i,selectedDiscId:r,hasSelection:c,isCurrent:n,onSelectDisc:o,discCount:u,isCpu:h=!1}=e;return(0,t.jsxs)("div",{className:"".concat((()=>{let e=a.HAND.CONTAINER_BASE,t=n&&!c?a.HAND.CONTAINER_ACTIVE:a.HAND.CONTAINER_INACTIVE;return"".concat(e," ").concat(t)})()," ").concat(n&&!c?a.HAND.BG_PULSE:""),children:[(0,t.jsxs)("div",{className:a.HAND.TITLE,children:[(()=>{let e="black"===s?l.BLACK_PLAYER:l.WHITE_PLAYER;return h?"".concat(e," (CPU)"):e})(),n&&l.CURRENT_TURN_SUFFIX]}),(0,t.jsxs)("div",{className:a.HAND.DISC_COUNT,children:["black"===s?l.BLACK:l.WHITE,": ",u]}),(0,t.jsx)("div",{className:a.HAND.MESSAGE_CONTAINER,children:n&&!c&&(0,t.jsx)("div",{className:a.HAND.MESSAGE_TEXT,children:l.SELECT_DISC_MESSAGE})}),(0,t.jsx)("div",{className:a.HAND.DISCS_CONTAINER,children:i.map(e=>(0,t.jsx)(d,{id:e.id,color:e.color,type:e.type,isUsed:e.isUsed,isSelected:r===e.id,isDisabled:!n,onClick:()=>o(e.id)},e.id))})]})};function h(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class m{isNormal(){return"normal"===this.type}isButter(){return"butter"===this.type}isCat(){return"cat"===this.type}isButterCat(){return"buttercat"===this.type}constructor(e,t="normal"){h(this,"color",void 0),h(this,"type",void 0),this.color=e,this.type=t}}class T{getDisk(e){return this.grid[e.y][e.x]}setDisk(e,t){this.grid[e.y][e.x]=t}clone(){return new T(this.grid)}isInBounds(e){return e.x>=0&&e.x<8&&e.y>=0&&e.y<8}toArray(){return this.grid.map(e=>e.slice())}constructor(e){h(this,"grid",void 0),e?this.grid=e.map(e=>e.slice()):(this.grid=Array.from({length:8},()=>Array(8).fill(null)),this.grid[3][3]=new m("white"),this.grid[3][4]=new m("black"),this.grid[4][3]=new m("black"),this.grid[4][4]=new m("white"))}}class _{equals(e){return this.x===e.x&&this.y===e.y}toString(){return"".concat(this.x,",").concat(this.y)}static directionOffsets(){let e=[];for(let t=-1;t<=1;t++)for(let s=-1;s<=1;s++)(0!==t||0!==s)&&e.push({dx:t,dy:s});return e}move(e,t){let s=this.x+e,i=this.y+t;return s<0||s>7||i<0||i>7?null:new _(s,i)}isInCenter16(){return this.x>=2&&this.x<=5&&this.y>=2&&this.y<=5}constructor(e,t){if(h(this,"x",void 0),h(this,"y",void 0),this.x=e,this.y=t,e<0||e>7||t<0||t>7)throw Error("Invalid position: (".concat(e,", ").concat(t,")"))}}let E=e=>"black"===e?"white":"black";class D{use(){return new D(this.id,this.color,this.type,!0)}reset(){return new D(this.id,this.color,this.type,!1)}isNormal(){return"normal"===this.type}isSpecial(){return"normal"!==this.type}constructor(e,t,s="normal",i=!1){if(h(this,"id",void 0),h(this,"color",void 0),h(this,"type",void 0),h(this,"isUsed",void 0),this.id=e,this.color=t,this.type=s,this.isUsed=i,e<0||e>7)throw Error("HandDisc id must be between 0 and 7")}}class C{randomDiscType(){if(this.discs.every(e=>"normal"===e.type)){let e=Math.random();return e<.33?"butter":e<.66?"cat":"buttercat"}let e=Math.random();return e<.7?"normal":e<.8?"butter":e<.9?"cat":"buttercat"}selectDisc(e){let t=this.discs.findIndex(t=>t.id===e);if(-1===t)throw Error("Disc with id ".concat(e," not found"));if(this.discs[t].isUsed)throw Error("Cannot select a used disc");let s=this.clone();return s.selectedDiscId=e,s}deselectDisc(){let e=this.clone();return e.selectedDiscId=null,e}useSelectedDisc(){if(null===this.selectedDiscId)throw Error("No disc is selected");let e=this.clone();return e.discs=this.discs.map(t=>{if(t.id===this.selectedDiscId){let s=e.randomDiscType();return new D(t.id,t.color,s,!1)}return t}),e.selectedDiscId=null,e}getSelectedDiscId(){return this.selectedDiscId}hasSelection(){return null!==this.selectedDiscId}getDiscs(){return this.discs}hasAvailableDiscs(){return this.discs.some(e=>!e.isUsed)}resetAllDiscs(){let e=this.clone();return e.discs=this.discs.map(e=>e.reset()),e.selectedDiscId=null,e}clone(){let e=this.discs.map(e=>new D(e.id,e.color,e.type,e.isUsed));return new C(this.discs[0].color,this.selectedDiscId,e)}constructor(e,t=null,s){if(h(this,"discs",void 0),h(this,"selectedDiscId",void 0),s)this.discs=s;else{let t=4*("black"!==e);this.discs=[new D(t+0,e),new D(t+1,e),new D(t+2,e),new D(t+3,e)]}this.selectedDiscId=t}}class S{selectHandDisc(e){let t=this.blackHand.getDiscs().find(t=>t.id===e),s=this.whiteHand.getDiscs().find(t=>t.id===e);if(t){this.whiteHand=this.whiteHand.deselectDisc();let t=this.blackHand.selectDisc(e);this.blackHand=t}else if(s){this.blackHand=this.blackHand.deselectDisc();let t=this.whiteHand.selectDisc(e);this.whiteHand=t}}deselectHandDisc(){let e=this.getCurrentHand().deselectDisc();this.setCurrentHand(e)}placeDisk(e,t){if(this.isOperationLocked||t!==this.currentTurn)return null;let s=this.getCurrentHand();if(!s.hasSelection())return null;let i=s.getSelectedDiscId();if(null===i)return null;let l=s.getDiscs().find(e=>e.id===i);if(!l)return null;let r=l.type;if("normal"!==r&&e.isInCenter16()||!this.canPlaceDisk(e,t))return null;let c=t;"butter"===r?c=E(t):"buttercat"===r&&(c=t);let a=new m(c,r);this.board.setDisk(e,a);let n=[];if("buttercat"===r){let e=this.getCurrentHand().useSelectedDisc();return this.setCurrentHand(e),this.currentTurn=E(this.currentTurn),n}let o="butter"===r?t:c;for(let t of _.directionOffsets()){let s=[],i=e.move(t.dx,t.dy);for(;i;){let e=this.board.getDisk(i);if(!e||e.isButterCat())break;if(e.color===E(o))s.push(i);else if(e.color===o){for(let e of s){let t=this.board.getDisk(e);t&&(t.isCat()||t.isButter()?this.board.setDisk(e,new m(t.color,t.type)):this.board.setDisk(e,new m(o,t.type)),n.push(e))}break}else break;i=i.move(t.dx,t.dy)}}let d=this.getCurrentHand().useSelectedDisc();return this.setCurrentHand(d),this.currentTurn=E(this.currentTurn),n}startFlipping(e){this.isOperationLocked=!0,this.flippingPositions.clear(),e.forEach(e=>{this.flippingPositions.add("".concat(e.x,",").concat(e.y))})}endFlipping(){this.isOperationLocked=!1,this.flippingPositions.clear()}isFlipping(e){return this.flippingPositions.has("".concat(e.x,",").concat(e.y))}isLocked(){return this.isOperationLocked}getValidMoves(e){let t=[],s=this.getHand(e),i=s.getSelectedDiscId(),l=null;if(null!==i){let e=s.getDiscs().find(e=>e.id===i);e&&(l=e.type)}for(let s=0;s<8;s++)for(let i=0;i<8;i++){let r=new _(i,s);!(l&&"normal"!==l&&r.isInCenter16())&&this.canPlaceDisk(r,e)&&t.push(r)}return t}canPlaceDisk(e,t){if(this.board.getDisk(e))return!1;for(let s of _.directionOffsets()){let i=e.move(s.dx,s.dy),l=!1;for(;i;){let e=this.board.getDisk(i);if(!e||e.isButterCat())break;if(e.color===E(t))l=!0;else if(e.color===t&&l)return!0;else break;i=i.move(s.dx,s.dy)}}return!1}hasValidMoves(){return this.getValidMoves(this.currentTurn).length>0}pass(){this.deselectHandDisc(),this.currentTurn=E(this.currentTurn)}isGameOver(){if(0===this.getValidMoves(this.currentTurn).length){let e=E(this.currentTurn);return 0===this.getValidMoves(e).length}return!1}getDiscCount(e){let t=0;for(let s=0;s<8;s++)for(let i=0;i<8;i++){let l=new _(i,s),r=this.board.getDisk(l);r&&r.color===e&&t++}return t}getWinner(){if(!this.isGameOver())return null;let e=this.getDiscCount("black"),t=this.getDiscCount("white");return e>t?"black":t>e?"white":"draw"}getCurrentTurn(){return this.currentTurn}getBoard(){return this.board}getBoardAsArray(){return this.board.toArray()}getCurrentHand(){return"black"===this.currentTurn?this.blackHand:this.whiteHand}getHand(e){return"black"===e?this.blackHand:this.whiteHand}setCurrentHand(e){"black"===this.currentTurn?this.blackHand=e:this.whiteHand=e}clone(){let e=new S(this.board.clone(),this.currentTurn);return e.isOperationLocked=this.isOperationLocked,e.flippingPositions=new Set(this.flippingPositions),e.blackHand=this.blackHand,e.whiteHand=this.whiteHand,e}constructor(e,t="black"){h(this,"board",void 0),h(this,"currentTurn",void 0),h(this,"flippingPositions",void 0),h(this,"isOperationLocked",void 0),h(this,"blackHand",void 0),h(this,"whiteHand",void 0),this.board=e||new T,this.currentTurn=t,this.flippingPositions=new Set,this.isOperationLocked=!1,this.blackHand=new C("black"),this.whiteHand=new C("white")}}class p{execute(e){let t=new _(e.x,e.y),s=this.game.getCurrentTurn(),i=this.game.placeDisk(t,s);return null===i?{success:!1,flippedPositions:[],gameState:this.getGameState()}:(i.length>0&&this.game.startFlipping(i),{success:!0,flippedPositions:i,gameState:this.getGameState()})}endFlipping(){return this.game.endFlipping(),this.getGameState()}selectHandDisc(e){return this.game.selectHandDisc(e),this.getGameState()}deselectHandDisc(){return this.game.deselectHandDisc(),this.getGameState()}pass(){return this.game.pass(),this.getGameState()}hasValidMoves(){return this.game.hasValidMoves()}getGame(){return this.game}getGameState(){let e=this.game.getBoardAsArray(),t=this.game.getCurrentTurn(),s=new Set(this.game.getValidMoves(t).map(e=>"".concat(e.x,",").concat(e.y))),i=e.map((e,t)=>e.map((e,i)=>{let l=new _(i,t);return{x:i,y:t,color:(null==e?void 0:e.color)||null,discType:(null==e?void 0:e.type)||null,isValidMove:s.has("".concat(i,",").concat(t)),isFlipping:this.game.isFlipping(l)}})),l=this.game.getHand("black"),r=this.game.getHand("white"),c={color:"black",discs:l.getDiscs().map(e=>({id:e.id,color:e.color,type:e.type,isUsed:e.isUsed})),selectedDiscId:l.getSelectedDiscId(),hasSelection:l.hasSelection()},a={color:"white",discs:r.getDiscs().map(e=>({id:e.id,color:e.color,type:e.type,isUsed:e.isUsed})),selectedDiscId:r.getSelectedDiscId(),hasSelection:r.hasSelection()};return{board:i,currentTurn:t,isGameOver:this.game.isGameOver(),isLocked:this.game.isLocked(),blackHand:c,whiteHand:a,blackDiscCount:this.game.getDiscCount("black"),whiteDiscCount:this.game.getDiscCount("white"),winner:this.game.getWinner(),hasValidMoves:this.game.hasValidMoves()}}constructor(e){h(this,"game",void 0),this.game=e}}var b=e.i(82162);let g=e=>{let{isOpen:s,onClose:i,onNewGame:r}=e,{settings:c,updateSettings:n}=(0,b.useGameSettings)();return s?(0,t.jsx)("div",{className:a.SETTINGS.OVERLAY,onClick:i,children:(0,t.jsxs)("div",{className:a.SETTINGS.MODAL,onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("h2",{className:a.SETTINGS.TITLE,children:l.SETTINGS_TITLE}),(0,t.jsxs)("div",{className:a.SETTINGS.SECTION,children:[(0,t.jsx)("label",{className:a.SETTINGS.LABEL,children:l.GAME_MODE_LABEL}),(0,t.jsxs)("select",{className:a.SETTINGS.SELECT,value:c.mode,onChange:e=>{n({mode:e.target.value})},children:[(0,t.jsx)("option",{value:"pvp",children:l.MODE_PVP}),(0,t.jsx)("option",{value:"cpu-easy",children:l.MODE_CPU_EASY}),(0,t.jsx)("option",{value:"cpu-hard",children:l.MODE_CPU_HARD})]})]}),"pvp"!==c.mode&&(0,t.jsxs)("div",{className:a.SETTINGS.SECTION,children:[(0,t.jsx)("label",{className:a.SETTINGS.LABEL,children:l.CPU_COLOR_LABEL}),(0,t.jsxs)("select",{className:a.SETTINGS.SELECT,value:c.cpuColor,onChange:e=>{n({cpuColor:e.target.value})},children:[(0,t.jsx)("option",{value:"black",children:l.BLACK}),(0,t.jsx)("option",{value:"white",children:l.WHITE})]})]}),(0,t.jsx)("button",{className:a.SETTINGS.BUTTON_PRIMARY,onClick:()=>{r(),i()},children:l.NEW_GAME_BUTTON}),(0,t.jsx)("button",{className:a.SETTINGS.BUTTON_SECONDARY,onClick:i,children:l.CLOSE_SETTINGS_BUTTON})]})}):null};class I{getAllValidMoves(e){let t=[],s=e.getCurrentTurn();for(let i of e.getHand(s).getDiscs().filter(e=>!e.isUsed)){let l=e.clone();for(let e of(l.selectHandDisc(i.id),l.getValidMoves(s)))t.push({discId:i.id,position:e})}return t}}class A extends I{decideMove(e){let t=e.getCurrentTurn(),s=e.getHand(t).getDiscs().filter(e=>!e.isUsed);if(0===s.length)return null;let i=s[0],l=e.clone();l.selectHandDisc(i.id);let r=l.getValidMoves(t);if(0===r.length)return null;let c=Math.floor(Math.random()*r.length),a=r[c];return{discId:i.id,position:a}}}class x extends I{decideMove(e){let t=this.getAllValidMoves(e);if(0===t.length)return null;let s=null,i=-1/0;for(let l of t){let t=e.clone();t.selectHandDisc(l.discId),t.placeDisk(l.position,t.getCurrentTurn());let r=this.minimax(t,this.MAX_DEPTH-1,-1/0,1/0,!1),c=e.getHand(e.getCurrentTurn()).getDiscs().find(e=>e.id===l.discId),a=r;c&&("cat"===c.type?a+=15:"butter"===c.type?a-=20:"buttercat"===c.type&&(a+=5)),a>i&&(i=a,s=l)}return s}minimax(e,t,s,i,l){if(0===t||e.isGameOver())return this.evaluatePosition(e);let r=e.getCurrentTurn(),c=this.getAllValidMoves(e);if(0===c.length){let r=e.clone();return r.pass(),this.minimax(r,t-1,s,i,!l)}if(l){let l=-1/0;for(let a of c){let c=e.clone();c.selectHandDisc(a.discId),c.placeDisk(a.position,r);let n=this.minimax(c,t-1,s,i,!1);if(l=Math.max(l,n),i<=(s=Math.max(s,n)))break}return l}{let l=1/0;for(let a of c){let c=e.clone();c.selectHandDisc(a.discId),c.placeDisk(a.position,r);let n=this.minimax(c,t-1,s,i,!0);if(l=Math.min(l,n),(i=Math.min(i,n))<=s)break}return l}}evaluatePosition(e){let t=e.getCurrentTurn(),s=E(t);if(e.isGameOver()){let i=e.getWinner();return i===t?1e4:i===s?-1e4:0}let i=0,l=e.getDiscCount(t),r=e.getDiscCount(s);return i+=(l-r)*(l+r>40?10:3),i+=this.evaluatePositionWeights(e,t),(i-=this.evaluatePositionWeights(e,s))+(e.getValidMoves(t).length-e.getValidMoves(s).length)*5}evaluatePositionWeights(e,t){let s=[[100,-20,10,5,5,10,-20,100],[-20,-50,-2,-2,-2,-2,-50,-20],[10,-2,5,1,1,5,-2,10],[5,-2,1,0,0,1,-2,5],[5,-2,1,0,0,1,-2,5],[10,-2,5,1,1,5,-2,10],[-20,-50,-2,-2,-2,-2,-50,-20],[100,-20,10,5,5,10,-20,100]],i=0;for(let l=0;l<8;l++)for(let r=0;r<8;r++){let c=new _(r,l),a=e.getBoard().getDisk(c);a&&a.color===t&&(i+=s[l][r])}return i}constructor(...e){super(...e),h(this,"MAX_DEPTH",3)}}function N(){let{settings:e}=(0,b.useGameSettings)(),[i,r]=(0,s.useState)(()=>new p(new S)),[c,n]=(0,s.useState)(i.getGameState()),[d,h]=(0,s.useState)(null),[m,T]=(0,s.useState)(!1),_=(0,s.useRef)(null);(0,s.useEffect)(()=>{"cpu-easy"===e.mode?_.current=new A:"cpu-hard"===e.mode?_.current=new x:_.current=null},[e.mode]),(0,s.useEffect)(()=>{if(d){let e=setTimeout(()=>{h(null)},3e3);return()=>clearTimeout(e)}},[d]),(0,s.useEffect)(()=>{if(!c.isGameOver&&!c.isLocked&&!c.hasValidMoves){let e=setTimeout(()=>{let e="black"===c.currentTurn?l.BLACK:l.WHITE;h("".concat(e).concat(l.PASS_MESSAGE)),n(i.pass())},1e3);return()=>clearTimeout(e)}},[c,i]),(0,s.useEffect)(()=>{if("pvp"===e.mode||!_.current||c.currentTurn!==e.cpuColor||c.isGameOver||c.isLocked||!c.hasValidMoves)return;let t=setTimeout(()=>{let e=i.getGame(),t=_.current.decideMove(e);t&&(n(i.selectHandDisc(t.discId)),setTimeout(()=>{let e=i.execute({x:t.position.x,y:t.position.y});e.success&&(n(e.gameState),e.flippedPositions.length>0&&setTimeout(()=>{n(i.endFlipping())},1e3))},500))},1e3);return()=>clearTimeout(t)},[c,e,i]);let E=t=>{("pvp"===e.mode||c.currentTurn!==e.cpuColor)&&n(i.selectHandDisc(t))};return(0,t.jsxs)("main",{className:a.PAGE.MAIN,children:[(0,t.jsx)("button",{className:a.SETTINGS.OPEN_BUTTON,onClick:()=>T(!0),children:l.OPEN_SETTINGS_BUTTON}),(0,t.jsx)(g,{isOpen:m,onClose:()=>T(!1),onNewGame:()=>{let e=new p(new S);r(e),n(e.getGameState()),h(null)}}),(0,t.jsx)("h1",{className:a.PAGE.TITLE,children:l.GAME_TITLE}),!c.isGameOver&&(0,t.jsx)("div",{className:a.PAGE.TURN_DISPLAY,children:d||(0,t.jsxs)(t.Fragment,{children:[l.CURRENT_TURN_LABEL," ","black"===c.currentTurn?l.BLACK:l.WHITE]})}),c.isGameOver&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:a.PAGE.GAME_OVER,children:l.GAME_OVER}),"black"===c.winner&&(0,t.jsx)("p",{className:a.PAGE.WINNER_MESSAGE,children:l.BLACK_WINS}),"white"===c.winner&&(0,t.jsx)("p",{className:a.PAGE.WINNER_MESSAGE,children:l.WHITE_WINS}),"draw"===c.winner&&(0,t.jsx)("p",{className:a.PAGE.WINNER_MESSAGE,children:l.DRAW})]}),(0,t.jsxs)("div",{className:a.PAGE.HANDS_CONTAINER,children:[(0,t.jsx)("div",{className:a.PAGE.HANDS_ITEM,children:(0,t.jsx)(u,{color:"black",discs:c.blackHand.discs,selectedDiscId:c.blackHand.selectedDiscId,hasSelection:c.blackHand.hasSelection,isCurrent:"black"===c.currentTurn,onSelectDisc:E,discCount:c.blackDiscCount,isCpu:"pvp"!==e.mode&&"black"===e.cpuColor})}),(0,t.jsx)("div",{className:a.PAGE.HANDS_ITEM,children:(0,t.jsx)(u,{color:"white",discs:c.whiteHand.discs,selectedDiscId:c.whiteHand.selectedDiscId,hasSelection:c.whiteHand.hasSelection,isCurrent:"white"===c.currentTurn,onSelectDisc:E,discCount:c.whiteDiscCount,isCpu:"pvp"!==e.mode&&"white"===e.cpuColor})})]}),(0,t.jsx)(o,{board:c.board,onCellClick:(t,s)=>{if("pvp"!==e.mode&&c.currentTurn===e.cpuColor||c.isGameOver||c.isLocked)return;let l=i.execute({x:t,y:s});l.success&&(n(l.gameState),l.flippedPositions.length>0&&setTimeout(()=>{n(i.endFlipping())},1e3))}}),(0,t.jsxs)("div",{className:a.SPECIAL_DISCS.CONTAINER,children:[(0,t.jsx)("h2",{className:a.SPECIAL_DISCS.TITLE,children:l.SPECIAL_DISCS_TITLE}),(0,t.jsxs)("div",{className:a.SPECIAL_DISCS.GRID,children:[(0,t.jsxs)("div",{className:"".concat(a.SPECIAL_DISCS.CARD_BASE," ").concat(a.SPECIAL_DISCS.CARD_BUTTER),children:[(0,t.jsxs)("div",{className:a.SPECIAL_DISCS.CARD_HEADER,children:[(0,t.jsx)("span",{className:a.SPECIAL_DISCS.CARD_EMOJI,children:l.BUTTER_EMOJI}),(0,t.jsx)("h3",{className:a.SPECIAL_DISCS.CARD_TITLE,children:l.BUTTER_DISC_TITLE})]}),(0,t.jsx)("p",{className:a.SPECIAL_DISCS.CARD_TEXT,children:l.BUTTER_DISC_DESCRIPTION})]}),(0,t.jsxs)("div",{className:"".concat(a.SPECIAL_DISCS.CARD_BASE," ").concat(a.SPECIAL_DISCS.CARD_CAT),children:[(0,t.jsxs)("div",{className:a.SPECIAL_DISCS.CARD_HEADER,children:[(0,t.jsx)("span",{className:a.SPECIAL_DISCS.CARD_EMOJI,children:l.CAT_EMOJI}),(0,t.jsx)("h3",{className:a.SPECIAL_DISCS.CARD_TITLE,children:l.CAT_DISC_TITLE})]}),(0,t.jsx)("p",{className:a.SPECIAL_DISCS.CARD_TEXT,children:l.CAT_DISC_DESCRIPTION})]}),(0,t.jsxs)("div",{className:"".concat(a.SPECIAL_DISCS.CARD_BASE," ").concat(a.SPECIAL_DISCS.CARD_BUTTERCAT),children:[(0,t.jsxs)("div",{className:a.SPECIAL_DISCS.CARD_HEADER,children:[(0,t.jsx)("span",{className:a.SPECIAL_DISCS.CARD_EMOJI,children:l.BUTTERCAT_EMOJI}),(0,t.jsx)("h3",{className:a.SPECIAL_DISCS.CARD_TITLE,children:l.BUTTERCAT_DISC_TITLE})]}),(0,t.jsx)("p",{className:a.SPECIAL_DISCS.CARD_TEXT,children:l.BUTTERCAT_DISC_DESCRIPTION})]})]})]})]})}}]);