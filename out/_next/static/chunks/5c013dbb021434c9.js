(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,95608,e=>{e.v({bottomLeft:"GuideDot-module__6pWM-a__bottomLeft",bottomRight:"GuideDot-module__6pWM-a__bottomRight",guideDot:"GuideDot-module__6pWM-a__guideDot",topLeft:"GuideDot-module__6pWM-a__topLeft",topRight:"GuideDot-module__6pWM-a__topRight"})},89633,e=>{e.v({black:"Disc-module__bexTPq__black",bottom:"Disc-module__bexTPq__bottom",disc:"Disc-module__bexTPq__disc",flip:"Disc-module__bexTPq__flip",flipToBlack:"Disc-module__bexTPq__flipToBlack",flipToWhite:"Disc-module__bexTPq__flipToWhite",flipping:"Disc-module__bexTPq__flipping",side:"Disc-module__bexTPq__side",top:"Disc-module__bexTPq__top",white:"Disc-module__bexTPq__white"})},52683,e=>{"use strict";e.s(["default",()=>w],52683);var t=e.i(43476),i=e.i(71645),s=e.i(95608),r=e.i(89633);let c=e=>{let{color:i,isFlipping:s}=e;return(0,t.jsxs)("div",{className:"".concat(r.default.disc," ").concat("black"===i?r.default.black:r.default.white," ").concat(s?r.default.flipping:""),"data-flipping-to":s?"black"===i?"black":"white":void 0,children:[(0,t.jsx)("div",{className:r.default.top}),(0,t.jsx)("div",{className:r.default.side}),(0,t.jsx)("div",{className:r.default.bottom})]})},l=e=>{let{x:i,y:r,color:l,isValidMove:n,isFlipping:o,onClick:a}=e,d=i%4==2&&r%4==2?s.default.topLeft:i%4==1&&r%4==2?s.default.topRight:i%4==2&&r%4==1?s.default.bottomLeft:i%4==1&&r%4==1?s.default.bottomRight:null;return(0,t.jsxs)("div",{className:"".concat("w-20 h-20 border border-neutral-900 flex items-center justify-center relative"," ").concat("bg-emerald-700"," ").concat(n?"cursor-pointer hover:bg-emerald-600":""),onClick:a,children:[l&&(0,t.jsx)(c,{color:l,isFlipping:o}),!l&&n&&(0,t.jsx)("div",{className:"rounded-full w-4 h-4 bg-yellow-300"}),d&&(0,t.jsx)("div",{className:"".concat(s.default.guideDot," ").concat(d)})]})},n=e=>{let{board:i,onCellClick:s}=e;return(0,t.jsx)("div",{className:"grid grid-cols-8 gap-0 border-4 border-neutral-900",children:i.map((e,i)=>e.map((e,r)=>(0,t.jsx)(l,{x:e.x,y:e.y,color:e.color,isValidMove:e.isValidMove,isFlipping:e.isFlipping,onClick:()=>s(e.x,e.y)},"".concat(r,"-").concat(i))))})},o=e=>{let{color:i,isUsed:s,isSelected:r,onClick:c}=e;return(0,t.jsx)("div",{className:"".concat("w-16 h-16 border-2 flex items-center justify-center cursor-pointer transition-all"," ").concat(r?"border-yellow-400 bg-yellow-100":"border-gray-400 bg-gray-100 hover:bg-gray-200"," ").concat(s?"opacity-30 cursor-not-allowed":""),onClick:s?void 0:c,children:!s&&(0,t.jsx)("div",{className:"rounded-full w-10 h-10 ".concat("black"===i?"bg-black":"bg-white border border-gray-300")})})},a=e=>{let{color:i,discs:s,selectedDiscId:r,hasSelection:c,isCurrent:l,onSelectDisc:n}=e,a="p-4 rounded-lg border-2 ".concat(l&&!c?"border-gray-300":"bg-gray-50 border-gray-300"),d=l&&!c?"animate-pulse bg-yellow-200":"";return(0,t.jsxs)("div",{className:"".concat(a," ").concat(d),children:[(0,t.jsxs)("div",{className:"mb-2 font-bold text-lg h-7",children:["black"===i?"黒プレイヤー":"白プレイヤー",l&&" (現在のターン)"]}),(0,t.jsx)("div",{className:"mb-2 h-5",children:l&&!c&&(0,t.jsx)("div",{className:"text-sm text-red-600",children:"手札からディスクを選択してください"})}),(0,t.jsx)("div",{className:"flex gap-2",children:s.map(e=>(0,t.jsx)(o,{id:e.id,color:e.color,isUsed:e.isUsed,isSelected:r===e.id,onClick:()=>n(e.id)},e.id))})]})};function d(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class h{constructor(e){d(this,"color",void 0),this.color=e}}class u{getDisk(e){return this.grid[e.y][e.x]}setDisk(e,t){this.grid[e.y][e.x]=t}clone(){return new u(this.grid)}isInBounds(e){return e.x>=0&&e.x<8&&e.y>=0&&e.y<8}toArray(){return this.grid.map(e=>e.slice())}constructor(e){d(this,"grid",void 0),e?this.grid=e.map(e=>e.slice()):(this.grid=Array.from({length:8},()=>Array(8).fill(null)),this.grid[3][3]=new h("white"),this.grid[3][4]=new h("black"),this.grid[4][3]=new h("black"),this.grid[4][4]=new h("white"))}}class g{equals(e){return this.x===e.x&&this.y===e.y}toString(){return"".concat(this.x,",").concat(this.y)}static directionOffsets(){let e=[];for(let t=-1;t<=1;t++)for(let i=-1;i<=1;i++)(0!==t||0!==i)&&e.push({dx:t,dy:i});return e}move(e,t){let i=this.x+e,s=this.y+t;return i<0||i>7||s<0||s>7?null:new g(i,s)}constructor(e,t){if(d(this,"x",void 0),d(this,"y",void 0),this.x=e,this.y=t,e<0||e>7||t<0||t>7)throw Error("Invalid position: (".concat(e,", ").concat(t,")"))}}let m=e=>"black"===e?"white":"black";class b{use(){return new b(this.id,this.color,!0)}reset(){return new b(this.id,this.color,!1)}constructor(e,t,i=!1){if(d(this,"id",void 0),d(this,"color",void 0),d(this,"isUsed",void 0),this.id=e,this.color=t,this.isUsed=i,e<0||e>3)throw Error("HandDisc id must be between 0 and 3")}}class p{selectDisc(e){if(e<0||e>3)throw Error("Disc id must be between 0 and 3");if(this.discs[e].isUsed)throw Error("Cannot select a used disc");let t=this.clone();return t.selectedDiscId=e,t}deselectDisc(){let e=this.clone();return e.selectedDiscId=null,e}useSelectedDisc(){if(null===this.selectedDiscId)throw Error("No disc is selected");let e=this.clone();return e.discs=this.discs.map(e=>e.reset()),e.selectedDiscId=null,e}getSelectedDiscId(){return this.selectedDiscId}hasSelection(){return null!==this.selectedDiscId}getDiscs(){return this.discs}hasAvailableDiscs(){return this.discs.some(e=>!e.isUsed)}resetAllDiscs(){let e=this.clone();return e.discs=this.discs.map(e=>e.reset()),e.selectedDiscId=null,e}clone(){let e=new p(this.discs[0].color,this.selectedDiscId);return e.discs=this.discs.map(e=>new b(e.id,e.color,e.isUsed)),e}constructor(e,t=null){d(this,"discs",void 0),d(this,"selectedDiscId",void 0),this.discs=[new b(0,e),new b(1,e),new b(2,e),new b(3,e)],this.selectedDiscId=t}}class f{selectHandDisc(e){let t=this.getCurrentHand().selectDisc(e);this.setCurrentHand(t)}deselectHandDisc(){let e=this.getCurrentHand().deselectDisc();this.setCurrentHand(e)}placeDisk(e,t){if(this.isOperationLocked||t!==this.currentTurn||!this.getCurrentHand().hasSelection()||!this.canPlaceDisk(e,t))return null;let i=new h(t);this.board.setDisk(e,i);let s=[];for(let i of g.directionOffsets()){let r=[],c=e.move(i.dx,i.dy);for(;c;){let e=this.board.getDisk(c);if(!e)break;if(e.color===m(t))r.push(c);else if(e.color===t){for(let e of r)this.board.setDisk(e,new h(t)),s.push(e);break}else break;c=c.move(i.dx,i.dy)}}let r=this.getCurrentHand().useSelectedDisc();return this.setCurrentHand(r),this.currentTurn=m(this.currentTurn),s}startFlipping(e){this.isOperationLocked=!0,this.flippingPositions.clear(),e.forEach(e=>{this.flippingPositions.add("".concat(e.x,",").concat(e.y))})}endFlipping(){this.isOperationLocked=!1,this.flippingPositions.clear()}isFlipping(e){return this.flippingPositions.has("".concat(e.x,",").concat(e.y))}isLocked(){return this.isOperationLocked}getValidMoves(e){let t=[];for(let i=0;i<8;i++)for(let s=0;s<8;s++){let r=new g(s,i);this.canPlaceDisk(r,e)&&t.push(r)}return t}canPlaceDisk(e,t){if(this.board.getDisk(e))return!1;for(let i of g.directionOffsets()){let s=e.move(i.dx,i.dy),r=!1;for(;s;){let e=this.board.getDisk(s);if(!e)break;if(e.color===m(t))r=!0;else if(e.color===t&&r)return!0;else break;s=s.move(i.dx,i.dy)}}return!1}isGameOver(){let e=this.getValidMoves("black"),t=this.getValidMoves("white");return 0===e.length&&0===t.length}getCurrentTurn(){return this.currentTurn}getBoard(){return this.board}getBoardAsArray(){return this.board.toArray()}getCurrentHand(){return"black"===this.currentTurn?this.blackHand:this.whiteHand}getHand(e){return"black"===e?this.blackHand:this.whiteHand}setCurrentHand(e){"black"===this.currentTurn?this.blackHand=e:this.whiteHand=e}clone(){let e=new f(this.board.clone(),this.currentTurn);return e.isOperationLocked=this.isOperationLocked,e.flippingPositions=new Set(this.flippingPositions),e.blackHand=this.blackHand,e.whiteHand=this.whiteHand,e}constructor(e,t="black"){d(this,"board",void 0),d(this,"currentTurn",void 0),d(this,"flippingPositions",void 0),d(this,"isOperationLocked",void 0),d(this,"blackHand",void 0),d(this,"whiteHand",void 0),this.board=e||new u,this.currentTurn=t,this.flippingPositions=new Set,this.isOperationLocked=!1,this.blackHand=new p("black"),this.whiteHand=new p("white")}}class x{execute(e){let t=new g(e.x,e.y),i=this.game.getCurrentTurn(),s=this.game.placeDisk(t,i);return null===s?{success:!1,flippedPositions:[],gameState:this.getGameState()}:(s.length>0&&this.game.startFlipping(s),{success:!0,flippedPositions:s,gameState:this.getGameState()})}endFlipping(){return this.game.endFlipping(),this.getGameState()}selectHandDisc(e){return this.game.selectHandDisc(e),this.getGameState()}deselectHandDisc(){return this.game.deselectHandDisc(),this.getGameState()}getGameState(){let e=this.game.getBoardAsArray(),t=this.game.getCurrentTurn(),i=new Set(this.game.getValidMoves(t).map(e=>"".concat(e.x,",").concat(e.y))),s=e.map((e,t)=>e.map((e,s)=>{let r=new g(s,t);return{x:s,y:t,color:(null==e?void 0:e.color)||null,isValidMove:i.has("".concat(s,",").concat(t)),isFlipping:this.game.isFlipping(r)}})),r=this.game.getHand("black"),c=this.game.getHand("white"),l={color:"black",discs:r.getDiscs().map(e=>({id:e.id,color:e.color,isUsed:e.isUsed})),selectedDiscId:r.getSelectedDiscId(),hasSelection:r.hasSelection()},n={color:"white",discs:c.getDiscs().map(e=>({id:e.id,color:e.color,isUsed:e.isUsed})),selectedDiscId:c.getSelectedDiscId(),hasSelection:c.hasSelection()};return{board:s,currentTurn:t,isGameOver:this.game.isGameOver(),isLocked:this.game.isLocked(),blackHand:l,whiteHand:n}}constructor(e){d(this,"game",void 0),this.game=e}}function w(){let[e]=(0,i.useState)(()=>new x(new f)),[s,r]=(0,i.useState)(e.getGameState()),c=t=>{r(e.selectHandDisc(t))};return(0,t.jsxs)("main",{className:"min-h-screen flex flex-col items-center justify-center bg-orange-200 p-8",children:[(0,t.jsx)("h1",{className:"text-3xl text-neutral-900 font-bold mb-4",children:"オセロゲーム"}),(0,t.jsxs)("div",{className:"mb-4 text-xl text-neutral-900",children:["現在のターン: ","black"===s.currentTurn?"黒":"白"]}),s.isGameOver&&(0,t.jsx)("p",{className:"mb-4 text-2xl text-red-600 font-bold",children:"ゲーム終了！"}),(0,t.jsxs)("div",{className:"flex gap-8 mb-8 w-full max-w-4xl",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)(a,{color:"black",discs:s.blackHand.discs,selectedDiscId:s.blackHand.selectedDiscId,hasSelection:s.blackHand.hasSelection,isCurrent:"black"===s.currentTurn,onSelectDisc:c})}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)(a,{color:"white",discs:s.whiteHand.discs,selectedDiscId:s.whiteHand.selectedDiscId,hasSelection:s.whiteHand.hasSelection,isCurrent:"white"===s.currentTurn,onSelectDisc:c})})]}),(0,t.jsx)(n,{board:s.board,onCellClick:(t,i)=>{if(s.isGameOver||s.isLocked)return;let c=e.execute({x:t,y:i});c.success&&(r(c.gameState),c.flippedPositions.length>0&&setTimeout(()=>{r(e.endFlipping())},1e3))}})]})}}]);